<% layout('layout') -%>

<script> 
    function edit() { 
	   document.getElementById('ProfileEdit').className='show';
	   document.getElementById('ProfileShow').className='hidden';         
       return false;
    } 
    function back() { 
       document.getElementById('ProfileEdit').className='hidden';
	   document.getElementById('ProfileShow').className='show';         
       return true;
    }
	function saveEmail(id){
		var newEmail = $('#inputEmail').val();
		$.ajax({
		   url: 'api/user/'+id+'/email',
		   type: 'PUT',
		   data: { email: newEmail},
		   success: function(html) {
				if(html)
				{	var myObjects = JSON.parse(html);
					$('div#returnstatus').append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert">&times;</button><strong>Success!</strong> Email changed ('+myObjects.status+').</div>');
				}else
				{
					$('div#returnstatus').append('<div class="alert alert-error"> <button type="button" class="close" data-dismiss="alert">&times;</button><strong>Error!</strong> Problem occured</div>');
				}
			}
		});
	}
	
	function savePassword(id){
		var newPassword = $('#inputPassword').val();
		$.ajax({
		   url: 'api/user/'+id+'/password',
		   type: 'PUT',
		   data: { password: newPassword},
		   success: function(html) {
				if(html)
				{	var myObjects = JSON.parse(html);
					$('div#returnstatus').append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert">&times;</button><strong>Success!</strong> Password changed ('+myObjects.status+').</div>');
				}else
				{
					$('div#returnstatus').append('<div class="alert alert-error"> <button type="button" class="close" data-dismiss="alert">&times;</button><strong>Error!</strong> Problem occured</div>');
				}
			}
		});
	}
</script> 

<section>
<div id="returnstatus">

</div>
<div class="col-sm-offset-2 col-sm-10">
	<img src="http://www.gravatar.com/avatar/<%= rest.emailHash %>" class="profileImg"/>
</div>
<form class="form-horizontal" role="form">
<div class="show" id="ProfileShow">
 <div class="form-group">
    <label class="col-sm-2 control-label">Name</label>
    <div class="col-sm-10">
      <p class="form-control-static"><%= rest.name %></p>
    </div>
  </div>
  
 <div class="form-group">
    <label class="col-sm-2 control-label">Email</label>
    <div class="col-sm-10">
      <p class="form-control-static"><%= rest.email %></p>
    </div>
  </div>
  
  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <button type="submit" class="btn btn-primary" onclick="return edit();">Edit</button>
    </div>
  </div>
</div>
<div class="hidden" id="ProfileEdit">
    <div class="form-group">
    <label class="col-sm-2 control-label">Name</label>
    <div class="col-sm-10">
      <p class="form-control-static"><%= rest.name %></p>
    </div>
  </div>
  
    <div class="form-group">
    <label for="inputEmail" class="col-sm-2 control-label">Email</label>
    <div class="col-sm-8">
      <input type="email" class="form-control" id="inputEmail" value="<%= rest.email %>">
    </div>
	<button type="button" class="btn btn-default" onclick="return saveEmail('<%= rest.name %>');" >-&gt;</button>
  </div>
  
   <div class="form-group">
    <label for="inputPassword" class="col-sm-2 control-label">Password</label>
    <div class="col-sm-8">
      <input type="password" class="form-control" id="inputPassword" placeholder="Password">
    </div>
	<button type="button" class="btn btn-default" onclick="return savePassword('<%= rest.name %>');" >-&gt;</button>
  </div>
  
    <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <button type="reset" class="btn btn-primary" onclick="return back();" >Back</button>
    </div>
  </div>
</div>
</form>


</section>
